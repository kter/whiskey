# Claude 3.5 Haiku vs Nova Pro コスト比較（楽天API数万件処理）

## 実測データに基づく比較

### 実際の処理実績（1,000件）
- **商品名平均長**: 約200トークン/件
- **出力結果平均**: 約150トークン/件
- **Nova Pro実績**: 100%認識率、confidence 0.9以上が約30%

## 料金比較（2025年1月時点）

| モデル | Input料金 | Output料金 | 特徴 |
|--------|-----------|------------|------|
| Claude 3.5 Haiku | $0.00025/1K tokens | $0.00125/1K tokens | 最安・高速・高精度 |
| Nova Pro | $0.0008/1K tokens | $0.0032/1K tokens | 中価格・中速・高精度 |
| Nova Lite | $0.0002/1K tokens | $0.0008/1K tokens | 低価格・高速・低精度 |

## 処理規模別コスト試算

### 10,000件処理
**想定トークン使用量:**
- Input: 10,000 × 0.2 = 2,000K tokens
- Output: 10,000 × 0.15 = 1,500K tokens

| モデル | Input費用 | Output費用 | 合計費用 | 円換算（¥150/$） |
|--------|-----------|------------|----------|------------------|
| Claude 3.5 Haiku | $0.50 | $1.88 | **$2.38** | **¥357** |
| Nova Pro | $1.60 | $4.80 | **$6.40** | **¥960** |
| Nova Lite | $0.40 | $1.20 | **$1.60** | **¥240** |

### 50,000件処理
**想定トークン使用量:**
- Input: 50,000 × 0.2 = 10,000K tokens
- Output: 50,000 × 0.15 = 7,500K tokens

| モデル | Input費用 | Output費用 | 合計費用 | 円換算（¥150/$） | 削減率 |
|--------|-----------|------------|----------|------------------|--------|
| **Nova Lite** | $2.00 | $6.00 | **$8.00** | **¥1,200** | **75%削減** |
| Claude 3.5 Haiku | $2.50 | $9.38 | **$11.88** | **¥1,782** | 63%削減 |
| Nova Pro | $8.00 | $24.00 | **$32.00** | **¥4,800** | 基準 |

## 品質比較

### 精度評価（推定）
| モデル | 認識率 | 高信頼度率 | JSON解析成功率 | 複数ウイスキー検出 |
|--------|--------|------------|---------------|------------------|
| Claude 3.5 Haiku | 95-98% | 80-90% | 95%+ | 優秀 |
| Nova Pro | 100% | 85-95% | 100% | 優秀 |
| Nova Lite | 70-85% | 30-50% | 30-70% | 課題あり |

### 処理速度比較
| モデル | バッチ処理時間 | 50,000件予想時間 | リトライ率 |
|--------|----------------|------------------|------------|
| Claude 3.5 Haiku | 6-8秒/10件 | 8-12時間 | 低 |
| Nova Pro | 10-12秒/10件 | 15-20時間 | 極低 |
| Nova Lite | 5-7秒/10件 | 6-10時間 | 高 |

## 推奨選択基準

### 🏆 Claude 3.5 Haiku（最推奨）
**使用ケース:**
- 月次バッチ処理（時間許容度高）
- コスト最適化優先
- 高品質データ必要

**メリット:**
- **コスト効率**: Nova Proの1/3の費用
- **高精度**: Nova Proと同等の品質期待
- **高速処理**: 処理時間も短縮
- **JSON安定性**: Claude系モデルの安定した出力

**デメリット:**
- 新モデルのため実績データ不足

### ⚡ Nova Pro（安定重視）
**使用ケース:**
- 実証済み安定性が必要
- 予算に余裕がある
- 100%の処理成功率必須

**メリット:**
- **実証済み品質**: 100%認識率
- **安定性**: JSON解析エラーなし
- **AWS純正**: AWS最適化済み

**デメリット:**
- **高コスト**: Claude Haikuの3倍
- **処理時間**: やや長い

### 💰 Nova Lite（非推奨）
**結論:** 品質とリトライコストを考慮すると実用的でない

## 実装推奨案

### Phase 1: Claude 3.5 Haiku テスト実装
```python
# Bedrockクライアント設定変更
self.model_id = "anthropic.claude-3-5-haiku-20241022-v1:0"
self.batch_size = 15  # Haikuは高速なので増量
self.api_rate_limit = 1.5  # レート制限緩和
```

### Phase 2: 品質検証
1. 1,000件でA/Bテスト実施
2. 精度・信頼度・処理時間を比較
3. 問題なければ本格運用へ

### Phase 3: 本格運用
- **目標**: 50,000件を¥1,800で処理
- **期間**: 1日で完了
- **品質**: confidence ≥ 0.9で高品質データ構築

## 総合推奨

### 🥇 Nova Lite（超コスト重視）
**使用ケース:**
- 最大限のコスト削減
- 大量データ処理（10万件以上）
- 品質よりも量を重視

**メリット:**
- **最安**: 50,000件で¥1,200（Nova Proの1/4）
- **高速**: 最も高速な処理
- **大量処理対応**: 低コストで数十万件可能

**デメリット:**
- **品質課題**: confidence低下、リトライ必要
- **後処理コスト**: 重複除去・品質向上に手間

### 🥈 Claude 3.5 Haiku（バランス重視）
バランスの取れた選択肢として推奨

### 実装戦略
**Nova Lite + 前処理最適化**で月額¥1,200で50,000件の大規模ウイスキーデータベース構築が実現可能です。